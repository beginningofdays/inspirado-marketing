<div class="flex-column mb-3">
    <h2>Filter Data:</h2>
    <!-- Filter Inputs in two rows and buttons in one row -->
    <div class="filter-container">
        <div class="filter-row mb-3">
            <label for="filterFirstname">First Name:</label>
            <input type="text" id="filterFirstname">
            
            <label for="filterLastname">Last Name:</label>
            <input type="text" id="filterLastname">
        
            <label for="filterCompanyName">Company Name:</label>
            <input type="text" id="filterCompanyName">
        </div>
        <div class="filter-row">
            <label for="filterEmail">Email:</label>
              <input type="text" id="filterEmail">
              
              <label for="filterDate">Date:</label>
              <input type="date" id="filterDate">
        </div>

        <div class="button-row">
            <button id="filterButton">Apply Filter</button>
            <button id="clearButton">Clear Filters</button>
        </div>

        <span class="admin-title"><h3>Data:</h3></span>
        <!-- Table container to make it responsive -->
        <div class="table-responsive">
            <table id="dataTable">
                <thead>
                    <tr>
                        <th>First Name</th>
                        <th>Last Name</th>
                        <th>Company Name</th>
                        <th>Email</th>
                        <th>Message</th>
                        <th>Date</th>
                    </tr>
                </thead>
                <tbody id="dataDisplay">
                    <!-- Rows will be inserted here dynamically -->
                </tbody>
            </table>
        </div>
        
    </div>
</div>


<script>
  // Define each entry
  interface MarketingInformation {
      firstName?: string;
      lastName?: string;
      companyName?: string;  
      email?: string;
      message?: string;      
      date?: string;
  }

  // Display data in the table
  function displayData(data: MarketingInformation[]) {
      const dataDisplay = document.getElementById('dataDisplay');
      if (dataDisplay) {
          dataDisplay.innerHTML = ''; // Clear previous content

          data.forEach(entry => {
              const row = document.createElement('tr');
              row.innerHTML = `
                  <td>${entry.firstName || 'N/A'}</td>
                  <td>${entry.lastName || 'N/A'}</td>
                  <td>${entry.companyName || 'N/A'}</td>
                  <td>${entry.email || 'N/A'}</td>
                  <td>${entry.message || 'N/A'}</td>
                  <td>${entry.date || 'N/A'}</td>
              `;
              dataDisplay.appendChild(row);

          });
          
      }
  }

  
  // Filters based on user input
  function applyFilter() {
      const filterFirstname = (document.getElementById('filterFirstname') as HTMLInputElement)?.value.toLowerCase() || '';
      const filterLastname = (document.getElementById('filterLastname') as HTMLInputElement)?.value.toLowerCase() || '';
      const filterCompanyName = (document.getElementById('filterCompanyName') as HTMLInputElement)?.value.toLowerCase() || '';
      const filterEmail = (document.getElementById('filterEmail') as HTMLInputElement)?.value.toLowerCase() || '';
      const filterDate = (document.getElementById('filterDate') as HTMLInputElement)?.value || '';

      const storedData = localStorage.getItem('sheetdb-form');
      let allData: MarketingInformation[] = storedData ? JSON.parse(storedData) : [];

      if (filterFirstname) {
          allData = allData.filter((entry: MarketingInformation) => 
              (entry.firstName || '').toLowerCase().includes(filterFirstname)
          );
      }
      if (filterLastname) {
          allData = allData.filter((entry: MarketingInformation) => 
              (entry.lastName || '').toLowerCase().includes(filterLastname)
          );
      }
      if (filterCompanyName) {
          allData = allData.filter((entry: MarketingInformation) => 
              (entry.companyName || '').toLowerCase().includes(filterCompanyName)
          );
      }
      if (filterEmail) {
          allData = allData.filter((entry: MarketingInformation) => 
              (entry.email || '').toLowerCase().includes(filterEmail)
          );
      }
      if (filterDate) {
          allData = allData.filter((entry: MarketingInformation) => 
              entry.date?.startsWith(filterDate)
          );
      }

      displayData(allData);
  }

  // Function to clear all filters
  function clearFilters() {
      const filterFirstname = document.getElementById('filterFirstname') as HTMLInputElement | null;
      const filterLastname = document.getElementById('filterLastname') as HTMLInputElement | null;
      const filterCompanyName = document.getElementById('filterCompanyName') as HTMLInputElement | null;
      const filterEmail = document.getElementById('filterEmail') as HTMLInputElement | null;
      const filterDate = document.getElementById('filterDate') as HTMLInputElement | null;

      if (filterFirstname) filterFirstname.value = '';
      if (filterLastname) filterLastname.value = '';
      if (filterCompanyName) filterCompanyName.value = '';
      if (filterEmail) filterEmail.value = '';
      if (filterDate) filterDate.value = '';

      const storedData = localStorage.getItem('sheetdb-form');
      displayData(storedData ? JSON.parse(storedData) : []);
  }

  // Set up event listeners for filter buttons
  document.addEventListener('DOMContentLoaded', function() {
      const filterButton = document.getElementById('filterButton');
      const clearButton = document.getElementById('clearButton');

      if (filterButton) filterButton.addEventListener('click', applyFilter);
      if (clearButton) clearButton.addEventListener('click', clearFilters);

      // Initial display of data
      const storedData = localStorage.getItem('sheetdb-form');
      displayData(storedData ? JSON.parse(storedData) : []);
  });
</script>

<!--LOCAL ADJUSTMENTS-->
<style>
.admin-title h3 {
  text-align: center;
  margin-top:10px;
}
</style>
